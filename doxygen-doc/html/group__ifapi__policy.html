<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>tpm2-tss: Policy calculation module</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">tpm2-tss
   &#160;<span id="projectnumber">4.0.1-44-g8699ab39</span>
   </div>
   <div id="projectbrief">TPM Software stack 2.0 TCG spec compliant implementation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('group__ifapi__policy.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Policy calculation module<div class="ingroups"><a class="el" href="group__fapi.html">Feature API</a> &raquo; <a class="el" href="group__ifapi.html">Internals of Feature API</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga959cdbfee441db40e08a25a6b5508312"><td class="memItemLeft" align="right" valign="top">TSS2_RC&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ifapi__policy.html#ga959cdbfee441db40e08a25a6b5508312">ifapi_calculate_policy</a> (<a class="el" href="struct_t_p_m_l___p_o_l_i_c_y_e_l_e_m_e_n_t_s.html">TPML_POLICYELEMENTS</a> *policy, TPML_DIGEST_VALUES *policyDigests, TPMI_ALG_HASH hash_alg, size_t hash_size, size_t digest_idx)</td></tr>
<tr class="separator:ga959cdbfee441db40e08a25a6b5508312"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9fbf90c59843f0add73e9d9de69f33d1"><td class="memItemLeft" align="right" valign="top">TSS2_RC&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ifapi__policy.html#ga9fbf90c59843f0add73e9d9de69f33d1">ifapi_calculate_policy_authorize</a> (<a class="el" href="struct_t_p_m_s___p_o_l_i_c_y_a_u_t_h_o_r_i_z_e.html">TPMS_POLICYAUTHORIZE</a> *policy, TPML_DIGEST_VALUES *current_digest, TPMI_ALG_HASH current_hash_alg)</td></tr>
<tr class="separator:ga9fbf90c59843f0add73e9d9de69f33d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga44f6a328290d32b03bd92de0a94f24ed"><td class="memItemLeft" align="right" valign="top">TSS2_RC&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ifapi__policy.html#ga44f6a328290d32b03bd92de0a94f24ed">ifapi_calculate_policy_authorize_nv</a> (<a class="el" href="struct_t_p_m_s___p_o_l_i_c_y_a_u_t_h_o_r_i_z_e_n_v.html">TPMS_POLICYAUTHORIZENV</a> *policy, TPML_DIGEST_VALUES *current_digest, TPMI_ALG_HASH current_hash_alg)</td></tr>
<tr class="separator:ga44f6a328290d32b03bd92de0a94f24ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa7f669753404880d5b0135f4eac1a54e"><td class="memItemLeft" align="right" valign="top">TSS2_RC&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ifapi__policy.html#gaa7f669753404880d5b0135f4eac1a54e">ifapi_calculate_policy_command_code</a> (<a class="el" href="struct_t_p_m_s___p_o_l_i_c_y_c_o_m_m_a_n_d_c_o_d_e.html">TPMS_POLICYCOMMANDCODE</a> *policy, TPML_DIGEST_VALUES *current_digest, TPMI_ALG_HASH current_hash_alg)</td></tr>
<tr class="separator:gaa7f669753404880d5b0135f4eac1a54e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9ed3dd6c381b21fb63dcb67c7a81bf14"><td class="memItemLeft" align="right" valign="top">TSS2_RC&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ifapi__policy.html#ga9ed3dd6c381b21fb63dcb67c7a81bf14">ifapi_calculate_policy_counter_timer</a> (<a class="el" href="struct_t_p_m_s___p_o_l_i_c_y_c_o_u_n_t_e_r_t_i_m_e_r.html">TPMS_POLICYCOUNTERTIMER</a> *policy, TPML_DIGEST_VALUES *current_digest, TPMI_ALG_HASH current_hash_alg)</td></tr>
<tr class="separator:ga9ed3dd6c381b21fb63dcb67c7a81bf14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa5dc445da32612ac83611cfad88318c4"><td class="memItemLeft" align="right" valign="top">TSS2_RC&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ifapi__policy.html#gaa5dc445da32612ac83611cfad88318c4">ifapi_calculate_policy_cp_hash</a> (<a class="el" href="struct_t_p_m_s___p_o_l_i_c_y_c_p_h_a_s_h.html">TPMS_POLICYCPHASH</a> *policy, TPML_DIGEST_VALUES *current_digest, TPMI_ALG_HASH current_hash_alg)</td></tr>
<tr class="separator:gaa5dc445da32612ac83611cfad88318c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaba6cdfe85baf4b0502d7d41d3a21ca8f"><td class="memItemLeft" align="right" valign="top">TSS2_RC&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ifapi__policy.html#gaba6cdfe85baf4b0502d7d41d3a21ca8f">ifapi_calculate_policy_digest_hash</a> (TPM2B_DIGEST *digest, TPML_DIGEST_VALUES *current_digest, TPMI_ALG_HASH current_hash_alg, TPM2_CC command_code)</td></tr>
<tr class="separator:gaba6cdfe85baf4b0502d7d41d3a21ca8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0e3b46d4597dea46f4c0b8d5c97029a9"><td class="memItemLeft" align="right" valign="top">TSS2_RC&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ifapi__policy.html#ga0e3b46d4597dea46f4c0b8d5c97029a9">ifapi_calculate_policy_duplicate</a> (<a class="el" href="struct_t_p_m_s___p_o_l_i_c_y_d_u_p_l_i_c_a_t_i_o_n_s_e_l_e_c_t.html">TPMS_POLICYDUPLICATIONSELECT</a> *policy, TPML_DIGEST_VALUES *current_digest, TPMI_ALG_HASH current_hash_alg)</td></tr>
<tr class="separator:ga0e3b46d4597dea46f4c0b8d5c97029a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0a040ee310af9b00e52889ee5f5d539a"><td class="memItemLeft" align="right" valign="top">TSS2_RC&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ifapi__policy.html#ga0a040ee310af9b00e52889ee5f5d539a">ifapi_calculate_policy_locality</a> (<a class="el" href="struct_t_p_m_s___p_o_l_i_c_y_l_o_c_a_l_i_t_y.html">TPMS_POLICYLOCALITY</a> *policy, TPML_DIGEST_VALUES *current_digest, TPMI_ALG_HASH current_hash_alg)</td></tr>
<tr class="separator:ga0a040ee310af9b00e52889ee5f5d539a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga770dcf38187e6356701ddfd6ece5f0eb"><td class="memItemLeft" align="right" valign="top">TSS2_RC&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ifapi__policy.html#ga770dcf38187e6356701ddfd6ece5f0eb">ifapi_calculate_policy_name_hash</a> (<a class="el" href="struct_t_p_m_s___p_o_l_i_c_y_n_a_m_e_h_a_s_h.html">TPMS_POLICYNAMEHASH</a> *policy, TPML_DIGEST_VALUES *current_digest, TPMI_ALG_HASH current_hash_alg)</td></tr>
<tr class="separator:ga770dcf38187e6356701ddfd6ece5f0eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga38c784847444e3b50e158f146d913d6a"><td class="memItemLeft" align="right" valign="top">TSS2_RC&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ifapi__policy.html#ga38c784847444e3b50e158f146d913d6a">ifapi_calculate_policy_nv</a> (<a class="el" href="struct_t_p_m_s___p_o_l_i_c_y_n_v.html">TPMS_POLICYNV</a> *policy, TPML_DIGEST_VALUES *current_digest, TPMI_ALG_HASH current_hash_alg)</td></tr>
<tr class="separator:ga38c784847444e3b50e158f146d913d6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga424e5a67a951be415c090f0c68da3329"><td class="memItemLeft" align="right" valign="top">TSS2_RC&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ifapi__policy.html#ga424e5a67a951be415c090f0c68da3329">ifapi_calculate_policy_nv_written</a> (<a class="el" href="struct_t_p_m_s___p_o_l_i_c_y_n_v_w_r_i_t_t_e_n.html">TPMS_POLICYNVWRITTEN</a> *policy, TPML_DIGEST_VALUES *current_digest, TPMI_ALG_HASH current_hash_alg)</td></tr>
<tr class="separator:ga424e5a67a951be415c090f0c68da3329"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafb80869164b6798e92befa69192caaf6"><td class="memItemLeft" align="right" valign="top">TSS2_RC&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ifapi__policy.html#gafb80869164b6798e92befa69192caaf6">ifapi_calculate_policy_or</a> (<a class="el" href="struct_t_p_m_s___p_o_l_i_c_y_o_r.html">TPMS_POLICYOR</a> *policyOr, TPML_DIGEST_VALUES *current_digest, TPMI_ALG_HASH hash_alg, size_t hash_size, size_t digest_idx)</td></tr>
<tr class="separator:gafb80869164b6798e92befa69192caaf6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga431512c41eeeb7120ce8c9849e3a8a60"><td class="memItemLeft" align="right" valign="top">TSS2_RC&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ifapi__policy.html#ga431512c41eeeb7120ce8c9849e3a8a60">ifapi_calculate_policy_secret</a> (<a class="el" href="struct_t_p_m_s___p_o_l_i_c_y_s_e_c_r_e_t.html">TPMS_POLICYSECRET</a> *policy, TPML_DIGEST_VALUES *current_digest, TPMI_ALG_HASH current_hash_alg)</td></tr>
<tr class="separator:ga431512c41eeeb7120ce8c9849e3a8a60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5471b7bf1a14125e033904d986629eb8"><td class="memItemLeft" align="right" valign="top">TSS2_RC&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ifapi__policy.html#ga5471b7bf1a14125e033904d986629eb8">ifapi_calculate_policy_signed</a> (<a class="el" href="struct_t_p_m_s___p_o_l_i_c_y_s_i_g_n_e_d.html">TPMS_POLICYSIGNED</a> *policy, TPML_DIGEST_VALUES *current_digest, TPMI_ALG_HASH current_hash_alg)</td></tr>
<tr class="separator:ga5471b7bf1a14125e033904d986629eb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaaf855bd0e68bacff034168df555d4412"><td class="memItemLeft" align="right" valign="top">TSS2_RC&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ifapi__policy.html#gaaf855bd0e68bacff034168df555d4412">ifapi_calculate_simple_policy</a> (TPM2_CC command_code1, TPM2_CC command_code2, TPML_DIGEST_VALUES *current_digest, TPMI_ALG_HASH current_hash_alg)</td></tr>
<tr class="separator:gaaf855bd0e68bacff034168df555d4412"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab244e28f8bce51e7806ba4a0b310b5b8"><td class="memItemLeft" align="right" valign="top">TSS2_RC&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ifapi__policy.html#gab244e28f8bce51e7806ba4a0b310b5b8">ifapi_compute_policy_pcr</a> (<a class="el" href="struct_t_p_m_s___p_o_l_i_c_y_p_c_r.html">TPMS_POLICYPCR</a> *policy, TPML_DIGEST_VALUES *current_digest, TPMI_ALG_HASH current_hash_alg)</td></tr>
<tr class="separator:gab244e28f8bce51e7806ba4a0b310b5b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Provides functions for policy calculation (without TPM). </p>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga959cdbfee441db40e08a25a6b5508312"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga959cdbfee441db40e08a25a6b5508312">&#9670;&nbsp;</a></span>ifapi_calculate_policy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TSS2_RC ifapi_calculate_policy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_t_p_m_l___p_o_l_i_c_y_e_l_e_m_e_n_t_s.html">TPML_POLICYELEMENTS</a> *&#160;</td>
          <td class="paramname"><em>policy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TPML_DIGEST_VALUES *&#160;</td>
          <td class="paramname"><em>policyDigests</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TPMI_ALG_HASH&#160;</td>
          <td class="paramname"><em>hash_alg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>hash_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>digest_idx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute policy digest for a list of policies.</p>
<p>Every policy in the list will update the previous policy. Thus the final policy digest will describe the sequential execution of the policy list.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">policy</td><td>The policy with the policy list. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">policyDigests</td><td>The digest list which has to be updated. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hash_alg</td><td>The hash algorithm used for the policy computation. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hash_size</td><td>The size of the policy digest. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">digest_idx</td><td>The index of the current policy in the passed digest list.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">TSS2_RC_SUCCESS</td><td>on success. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_VALUE</td><td>if an invalid value was passed into the function. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_GENERAL_FAILURE</td><td>if an internal error occurred. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_REFERENCE</td><td>a invalid null pointer is passed. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_MEMORY</td><td>if not enough memory can be allocated. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga9fbf90c59843f0add73e9d9de69f33d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9fbf90c59843f0add73e9d9de69f33d1">&#9670;&nbsp;</a></span>ifapi_calculate_policy_authorize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TSS2_RC ifapi_calculate_policy_authorize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_t_p_m_s___p_o_l_i_c_y_a_u_t_h_o_r_i_z_e.html">TPMS_POLICYAUTHORIZE</a> *&#160;</td>
          <td class="paramname"><em>policy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TPML_DIGEST_VALUES *&#160;</td>
          <td class="paramname"><em>current_digest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TPMI_ALG_HASH&#160;</td>
          <td class="paramname"><em>current_hash_alg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculate a policy digest for a placeholder policy.</p>
<p>The placeholder policy can be extended during execution by a signed policy, which can be verified by using the parameters of this placeholder policy. Based on the command code, the key name of the signing key and a policy reference the new policy digest is computed by the function calculate_policy_key_param().</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">policy</td><td>The policy with the name of the public key and the policy reference. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">current_digest</td><td>The digest list which has to be updated. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">current_hash_alg</td><td>The hash algorithm used for the policy computation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">TSS2_RC_SUCCESS</td><td>on success. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_VALUE</td><td>if an invalid value was passed into the function. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_GENERAL_FAILURE</td><td>if an internal error occurred. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_REFERENCE</td><td>a invalid null pointer is passed. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_MEMORY</td><td>if not enough memory can be allocated. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga44f6a328290d32b03bd92de0a94f24ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga44f6a328290d32b03bd92de0a94f24ed">&#9670;&nbsp;</a></span>ifapi_calculate_policy_authorize_nv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TSS2_RC ifapi_calculate_policy_authorize_nv </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_t_p_m_s___p_o_l_i_c_y_a_u_t_h_o_r_i_z_e_n_v.html">TPMS_POLICYAUTHORIZENV</a> *&#160;</td>
          <td class="paramname"><em>policy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TPML_DIGEST_VALUES *&#160;</td>
          <td class="paramname"><em>current_digest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TPMI_ALG_HASH&#160;</td>
          <td class="paramname"><em>current_hash_alg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculate a policy digest for a policy stored in an approved NV index.</p>
<p>Based on the command code, and the computed NV name the new policy digest is computed by the function calculate_policy_key_param().</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">policy</td><td>The policy with the public information of the NV index. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">current_digest</td><td>The digest list which has to be updated. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">current_hash_alg</td><td>The hash algorithm used for the policy computation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">TSS2_RC_SUCCESS</td><td>on success. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_VALUE</td><td>if an invalid value was passed into the function. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_REFERENCE</td><td>a invalid null pointer is passed. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_MEMORY</td><td>if not enough memory can be allocated. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_GENERAL_FAILURE</td><td>if an internal error occurred. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gaa7f669753404880d5b0135f4eac1a54e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa7f669753404880d5b0135f4eac1a54e">&#9670;&nbsp;</a></span>ifapi_calculate_policy_command_code()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TSS2_RC ifapi_calculate_policy_command_code </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_t_p_m_s___p_o_l_i_c_y_c_o_m_m_a_n_d_c_o_d_e.html">TPMS_POLICYCOMMANDCODE</a> *&#160;</td>
          <td class="paramname"><em>policy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TPML_DIGEST_VALUES *&#160;</td>
          <td class="paramname"><em>current_digest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TPMI_ALG_HASH&#160;</td>
          <td class="paramname"><em>current_hash_alg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Update policy command code with a command code defined in the policy.</p>
<p>For the update two command codes will be used. The command code of policy command code and the passed command code. The policy will be updated with the function <a class="el" href="group__ifapi__policy.html#gaaf855bd0e68bacff034168df555d4412">ifapi_calculate_simple_policy()</a></p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">policy</td><td>The policy command code with the second command code. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">current_digest</td><td>The digest list which has to be updated. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">current_hash_alg</td><td>The hash algorithm used for the policy computation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">TSS2_RC_SUCCESS</td><td>on success. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_VALUE</td><td>if an invalid value was passed into the function. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_GENERAL_FAILURE</td><td>if an internal error occurred. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_REFERENCE</td><td>a invalid null pointer is passed. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_MEMORY</td><td>if not enough memory can be allocated. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga9ed3dd6c381b21fb63dcb67c7a81bf14"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9ed3dd6c381b21fb63dcb67c7a81bf14">&#9670;&nbsp;</a></span>ifapi_calculate_policy_counter_timer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TSS2_RC ifapi_calculate_policy_counter_timer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_t_p_m_s___p_o_l_i_c_y_c_o_u_n_t_e_r_t_i_m_e_r.html">TPMS_POLICYCOUNTERTIMER</a> *&#160;</td>
          <td class="paramname"><em>policy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TPML_DIGEST_VALUES *&#160;</td>
          <td class="paramname"><em>current_digest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TPMI_ALG_HASH&#160;</td>
          <td class="paramname"><em>current_hash_alg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculate a policy for for comparing current TPM timers with the policy.</p>
<p>The timer value and the operation for comparison defined in the policy will bu used to update the policy digest. The offset which is supported by the TPM policy for FAPI will be 0.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">policy</td><td>The policy with the timer value and the operation for comparison. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">current_digest</td><td>The digest list which has to be updated. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">current_hash_alg</td><td>The hash algorithm used for the policy computation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">TSS2_RC_SUCCESS</td><td>on success. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_VALUE</td><td>if an invalid value was passed into the function. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_GENERAL_FAILURE</td><td>if an internal error occurred. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_REFERENCE</td><td>a invalid null pointer is passed. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_MEMORY</td><td>if not enough memory can be allocated. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gaa5dc445da32612ac83611cfad88318c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa5dc445da32612ac83611cfad88318c4">&#9670;&nbsp;</a></span>ifapi_calculate_policy_cp_hash()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TSS2_RC ifapi_calculate_policy_cp_hash </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_t_p_m_s___p_o_l_i_c_y_c_p_h_a_s_h.html">TPMS_POLICYCPHASH</a> *&#160;</td>
          <td class="paramname"><em>policy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TPML_DIGEST_VALUES *&#160;</td>
          <td class="paramname"><em>current_digest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TPMI_ALG_HASH&#160;</td>
          <td class="paramname"><em>current_hash_alg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute policy bound to a specific command and command parameters.</p>
<p>The cp hash value and the command code will be updated by the function <a class="el" href="group__ifapi__policy.html#gaba6cdfe85baf4b0502d7d41d3a21ca8f">ifapi_calculate_policy_digest_hash()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">policy</td><td>The policy with the cp hash value. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">current_digest</td><td>The digest list which has to be updated. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">current_hash_alg</td><td>The hash algorithm used for the policy computation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">TSS2_RC_SUCCESS</td><td>on success. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_VALUE</td><td>if an invalid value was passed into the function. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_GENERAL_FAILURE</td><td>if an internal error occurred. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_REFERENCE</td><td>a invalid null pointer is passed. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_MEMORY</td><td>if not enough memory can be allocated. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gaba6cdfe85baf4b0502d7d41d3a21ca8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaba6cdfe85baf4b0502d7d41d3a21ca8f">&#9670;&nbsp;</a></span>ifapi_calculate_policy_digest_hash()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TSS2_RC ifapi_calculate_policy_digest_hash </td>
          <td>(</td>
          <td class="paramtype">TPM2B_DIGEST *&#160;</td>
          <td class="paramname"><em>digest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TPML_DIGEST_VALUES *&#160;</td>
          <td class="paramname"><em>current_digest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TPMI_ALG_HASH&#160;</td>
          <td class="paramname"><em>current_hash_alg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TPM2_CC&#160;</td>
          <td class="paramname"><em>command_code</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute policy if only a digest and a command code are needed for extension.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">digest</td><td>the digest which will be used for policy extension. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">current_digest</td><td>The digest list which has to be updated. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">current_hash_alg</td><td>The hash algorithm used for the policy computation. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">command_code</td><td>The compute of the command which did compute the digest.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">TSS2_RC_SUCCESS</td><td>on success. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_VALUE</td><td>if an invalid value was passed into the function. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_GENERAL_FAILURE</td><td>if an internal error occurred. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_REFERENCE</td><td>a invalid null pointer is passed. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_MEMORY</td><td>if not enough memory can be allocated. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga0e3b46d4597dea46f4c0b8d5c97029a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0e3b46d4597dea46f4c0b8d5c97029a9">&#9670;&nbsp;</a></span>ifapi_calculate_policy_duplicate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TSS2_RC ifapi_calculate_policy_duplicate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_t_p_m_s___p_o_l_i_c_y_d_u_p_l_i_c_a_t_i_o_n_s_e_l_e_c_t.html">TPMS_POLICYDUPLICATIONSELECT</a> *&#160;</td>
          <td class="paramname"><em>policy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TPML_DIGEST_VALUES *&#160;</td>
          <td class="paramname"><em>current_digest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TPMI_ALG_HASH&#160;</td>
          <td class="paramname"><em>current_hash_alg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculate a policy digest to allow duplication force a selected new parent.</p>
<p>Based on the command code, the name of the new parent, and the include object switch the new policy digest is computed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">policy</td><td>The policy with the new parent information. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">current_digest</td><td>The digest list which has to be updated. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">current_hash_alg</td><td>The hash algorithm used for the policy computation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">TSS2_RC_SUCCESS</td><td>on success. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_VALUE</td><td>if an invalid value was passed into the function. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_GENERAL_FAILURE</td><td>if an internal error occurred. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_REFERENCE</td><td>a invalid null pointer is passed. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_MEMORY</td><td>if not enough memory can be allocated. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga0a040ee310af9b00e52889ee5f5d539a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0a040ee310af9b00e52889ee5f5d539a">&#9670;&nbsp;</a></span>ifapi_calculate_policy_locality()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TSS2_RC ifapi_calculate_policy_locality </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_t_p_m_s___p_o_l_i_c_y_l_o_c_a_l_i_t_y.html">TPMS_POLICYLOCALITY</a> *&#160;</td>
          <td class="paramname"><em>policy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TPML_DIGEST_VALUES *&#160;</td>
          <td class="paramname"><em>current_digest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TPMI_ALG_HASH&#160;</td>
          <td class="paramname"><em>current_hash_alg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute policy which limits authorization to a specific locality.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">policy</td><td>The policy with the locality. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">current_digest</td><td>The digest list which has to be updated. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">current_hash_alg</td><td>The hash algorithm used for the policy computation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">TSS2_RC_SUCCESS</td><td>on success. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_VALUE</td><td>if an invalid value was passed into the function. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_GENERAL_FAILURE</td><td>if an internal error occurred. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_REFERENCE</td><td>a invalid null pointer is passed. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_MEMORY</td><td>if not enough memory can be allocated. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga770dcf38187e6356701ddfd6ece5f0eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga770dcf38187e6356701ddfd6ece5f0eb">&#9670;&nbsp;</a></span>ifapi_calculate_policy_name_hash()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TSS2_RC ifapi_calculate_policy_name_hash </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_t_p_m_s___p_o_l_i_c_y_n_a_m_e_h_a_s_h.html">TPMS_POLICYNAMEHASH</a> *&#160;</td>
          <td class="paramname"><em>policy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TPML_DIGEST_VALUES *&#160;</td>
          <td class="paramname"><em>current_digest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TPMI_ALG_HASH&#160;</td>
          <td class="paramname"><em>current_hash_alg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute policy bound to a specific set of TPM entities.</p>
<p>The policy digest will be updated with the function <a class="el" href="group__ifapi__policy.html#gaba6cdfe85baf4b0502d7d41d3a21ca8f">ifapi_calculate_policy_digest_hash()</a> which will add the hash of the entity name list.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">policy</td><td>The policy with the list of entity names. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">current_digest</td><td>The digest list which has to be updated. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">current_hash_alg</td><td>The hash algorithm used for the policy computation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">TSS2_RC_SUCCESS</td><td>on success. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_VALUE</td><td>if an invalid value was passed into the function. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_GENERAL_FAILURE</td><td>if an internal error occurred. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_REFERENCE</td><td>a invalid null pointer is passed. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_MEMORY</td><td>if not enough memory can be allocated. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga38c784847444e3b50e158f146d913d6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga38c784847444e3b50e158f146d913d6a">&#9670;&nbsp;</a></span>ifapi_calculate_policy_nv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TSS2_RC ifapi_calculate_policy_nv </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_t_p_m_s___p_o_l_i_c_y_n_v.html">TPMS_POLICYNV</a> *&#160;</td>
          <td class="paramname"><em>policy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TPML_DIGEST_VALUES *&#160;</td>
          <td class="paramname"><em>current_digest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TPMI_ALG_HASH&#160;</td>
          <td class="paramname"><em>current_hash_alg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute policy bound to the content of an NV index.</p>
<p>The value used for comparison, the compare operation and an offset for the NV index are part of the policy.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">policy</td><td>The policy with the expected values used for comparison. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">current_digest</td><td>The digest list which has to be updated. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">current_hash_alg</td><td>The hash algorithm used for the policy computation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">TSS2_RC_SUCCESS</td><td>on success. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_GENERAL_FAILURE</td><td>if an internal error occurred. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_REFERENCE</td><td>a invalid null pointer is passed. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_MEMORY</td><td>if not enough memory can be allocated. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_VALUE</td><td>if an invalid value was passed into the function. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga424e5a67a951be415c090f0c68da3329"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga424e5a67a951be415c090f0c68da3329">&#9670;&nbsp;</a></span>ifapi_calculate_policy_nv_written()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TSS2_RC ifapi_calculate_policy_nv_written </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_t_p_m_s___p_o_l_i_c_y_n_v_w_r_i_t_t_e_n.html">TPMS_POLICYNVWRITTEN</a> *&#160;</td>
          <td class="paramname"><em>policy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TPML_DIGEST_VALUES *&#160;</td>
          <td class="paramname"><em>current_digest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TPMI_ALG_HASH&#160;</td>
          <td class="paramname"><em>current_hash_alg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute policy bound to bound to the TPMA_NV_WRITTEN attributes.</p>
<p>The expected value of the NV written attribute is part of the policy.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">policy</td><td>The policy with the expected attribute value. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">current_digest</td><td>The digest list which has to be updated. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">current_hash_alg</td><td>The hash algorithm used for the policy computation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">TSS2_RC_SUCCESS</td><td>on success. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_VALUE</td><td>if an invalid value was passed into the function. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_GENERAL_FAILURE</td><td>if an internal error occurred. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_REFERENCE</td><td>a invalid null pointer is passed. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_MEMORY</td><td>if not enough memory can be allocated. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gafb80869164b6798e92befa69192caaf6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gafb80869164b6798e92befa69192caaf6">&#9670;&nbsp;</a></span>ifapi_calculate_policy_or()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TSS2_RC ifapi_calculate_policy_or </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_t_p_m_s___p_o_l_i_c_y_o_r.html">TPMS_POLICYOR</a> *&#160;</td>
          <td class="paramname"><em>policyOr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TPML_DIGEST_VALUES *&#160;</td>
          <td class="paramname"><em>current_digest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TPMI_ALG_HASH&#160;</td>
          <td class="paramname"><em>hash_alg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>hash_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>digest_idx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute a list of policies to enable authorization options.</p>
<p>First the policy digest will be computed for every branch. After that the policy digest will be reset to zero and extended by the list of computed policy digests of the branches.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">policyOr</td><td>The policy with the possible policy branches. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">current_digest</td><td>The digest list which has to be updated. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hash_alg</td><td>The hash algorithm used for the policy computation. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hash_size</td><td>The size of the policy digest. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">digest_idx</td><td>The index of the current policy in the passed digest list.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">TSS2_RC_SUCCESS</td><td>on success. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_VALUE</td><td>if an invalid value was passed into the function. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_GENERAL_FAILURE</td><td>if an internal error occurred. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_REFERENCE</td><td>a invalid null pointer is passed. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_MEMORY</td><td>if not enough memory can be allocated. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga431512c41eeeb7120ce8c9849e3a8a60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga431512c41eeeb7120ce8c9849e3a8a60">&#9670;&nbsp;</a></span>ifapi_calculate_policy_secret()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TSS2_RC ifapi_calculate_policy_secret </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_t_p_m_s___p_o_l_i_c_y_s_e_c_r_e_t.html">TPMS_POLICYSECRET</a> *&#160;</td>
          <td class="paramname"><em>policy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TPML_DIGEST_VALUES *&#160;</td>
          <td class="paramname"><em>current_digest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TPMI_ALG_HASH&#160;</td>
          <td class="paramname"><em>current_hash_alg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculate a policy for adding secret-based authorization.</p>
<p>During execution proving the knowledge of the secrect auth value of a certain object is required. The name of this object and a policy reference is used for policy calculation. Based on the command code, the object name and a policy reference the new policy digest is computed by the function calculate_policy_key_param().</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">policy</td><td>The policy with the object name of the object to be authorized and the policy reference. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">current_digest</td><td>The digest list which has to be updated. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">current_hash_alg</td><td>The hash algorithm used for the policy computation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">TSS2_RC_SUCCESS</td><td>on success. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_VALUE</td><td>if an invalid value was passed into the function. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_GENERAL_FAILURE</td><td>if an internal error occurred. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_REFERENCE</td><td>a invalid null pointer is passed. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_MEMORY</td><td>if not enough memory can be allocated. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga5471b7bf1a14125e033904d986629eb8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5471b7bf1a14125e033904d986629eb8">&#9670;&nbsp;</a></span>ifapi_calculate_policy_signed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TSS2_RC ifapi_calculate_policy_signed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_t_p_m_s___p_o_l_i_c_y_s_i_g_n_e_d.html">TPMS_POLICYSIGNED</a> *&#160;</td>
          <td class="paramname"><em>policy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TPML_DIGEST_VALUES *&#160;</td>
          <td class="paramname"><em>current_digest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TPMI_ALG_HASH&#160;</td>
          <td class="paramname"><em>current_hash_alg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculate a policy digest for a signed policy.</p>
<p>Based on the command code, the public key, and the policy reference stored in the policy the new policy digest is computed by the function calculate_policy_key_param().</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">policy</td><td>The policy with the public key and the policy reference. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">current_digest</td><td>The digest list which has to be updated. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">current_hash_alg</td><td>The hash algorithm used for the policy computation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">TSS2_RC_SUCCESS</td><td>on success. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_VALUE</td><td>if an invalid value was passed into the function. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_GENERAL_FAILURE</td><td>if an internal error occurred. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_REFERENCE</td><td>a invalid null pointer is passed. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_MEMORY</td><td>if not enough memory can be allocated. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gaaf855bd0e68bacff034168df555d4412"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaaf855bd0e68bacff034168df555d4412">&#9670;&nbsp;</a></span>ifapi_calculate_simple_policy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TSS2_RC ifapi_calculate_simple_policy </td>
          <td>(</td>
          <td class="paramtype">TPM2_CC&#160;</td>
          <td class="paramname"><em>command_code1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TPM2_CC&#160;</td>
          <td class="paramname"><em>command_code2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TPML_DIGEST_VALUES *&#160;</td>
          <td class="paramname"><em>current_digest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TPMI_ALG_HASH&#160;</td>
          <td class="paramname"><em>current_hash_alg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Update policy if only the command codes are used.</p>
<p>Some simple policies use onle one or two command codes for policy calculation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">command_code1</td><td>The first command code for policy extension. Can be NULL. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">command_code2</td><td>The second command code for policy extension. Can be NULL. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">current_digest</td><td>The digest list which has to be updated. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">current_hash_alg</td><td>The hash algorithm used for the policy computation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">TSS2_RC_SUCCESS</td><td>on success. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_VALUE</td><td>if an invalid value was passed into the function. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_GENERAL_FAILURE</td><td>if an internal error occurred. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_REFERENCE</td><td>a invalid null pointer is passed. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_MEMORY</td><td>if not enough memory can be allocated. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gab244e28f8bce51e7806ba4a0b310b5b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab244e28f8bce51e7806ba4a0b310b5b8">&#9670;&nbsp;</a></span>ifapi_compute_policy_pcr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TSS2_RC ifapi_compute_policy_pcr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_t_p_m_s___p_o_l_i_c_y_p_c_r.html">TPMS_POLICYPCR</a> *&#160;</td>
          <td class="paramname"><em>policy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TPML_DIGEST_VALUES *&#160;</td>
          <td class="paramname"><em>current_digest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TPMI_ALG_HASH&#160;</td>
          <td class="paramname"><em>current_hash_alg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculate a policy digest for a certain PCR selection.</p>
<p>From a PCR list the list of PCR values and the corresponding PCR digest is computed. The passed policy digest will be extended with this data and also with the policy command code.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">policy</td><td>The policy with the list of selected PCRs. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">current_digest</td><td>The digest list which has to be updated. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">current_hash_alg</td><td>The hash algorithm used for the policy computation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">TSS2_RC_SUCCESS</td><td>on success. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_VALUE</td><td>if an invalid value was passed into the function. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_GENERAL_FAILURE</td><td>if an internal error occurred. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_REFERENCE</td><td>a invalid null pointer is passed. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_MEMORY</td><td>if not enough memory can be allocated. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
