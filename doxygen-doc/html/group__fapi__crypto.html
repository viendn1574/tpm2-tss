<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>tpm2-tss: Internal Cryptographic Backend</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">tpm2-tss
   &#160;<span id="projectnumber">4.0.1-44-g8699ab39</span>
   </div>
   <div id="projectbrief">TPM Software stack 2.0 TCG spec compliant implementation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('group__fapi__crypto.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Internal Cryptographic Backend<div class="ingroups"><a class="el" href="group__fapi.html">Feature API</a> &raquo; <a class="el" href="group__ifapi.html">Internals of Feature API</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga335ce751f0d6d9288608568872cec24b"><td class="memItemLeft" align="right" valign="top">TSS2_RC&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fapi__crypto.html#ga335ce751f0d6d9288608568872cec24b">ifapi_cert_to_pem</a> (const uint8_t *certBuffer, size_t certBufferSize, char **pemCert, TPM2_ALG_ID *certAlgorithmId, TPM2B_PUBLIC *tpmPublic)</td></tr>
<tr class="separator:ga335ce751f0d6d9288608568872cec24b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga037db3129ad84c8a032e1f3ac3233f0d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fapi__crypto.html#ga037db3129ad84c8a032e1f3ac3233f0d">ifapi_crypto_hash_abort</a> (<a class="el" href="struct___i_f_a_p_i___c_r_y_p_t_o___c_o_n_t_e_x_t.html">IFAPI_CRYPTO_CONTEXT_BLOB</a> **context)</td></tr>
<tr class="separator:ga037db3129ad84c8a032e1f3ac3233f0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae2feeff96f78225620819f2f6217964e"><td class="memItemLeft" align="right" valign="top">TSS2_RC&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fapi__crypto.html#gae2feeff96f78225620819f2f6217964e">ifapi_crypto_hash_finish</a> (<a class="el" href="struct___i_f_a_p_i___c_r_y_p_t_o___c_o_n_t_e_x_t.html">IFAPI_CRYPTO_CONTEXT_BLOB</a> **context, uint8_t *digest, size_t *digestSize)</td></tr>
<tr class="separator:gae2feeff96f78225620819f2f6217964e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1bae9ed161278e58f8e39d70f110b046"><td class="memItemLeft" align="right" valign="top">TSS2_RC&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fapi__crypto.html#ga1bae9ed161278e58f8e39d70f110b046">ifapi_crypto_hash_start</a> (<a class="el" href="struct___i_f_a_p_i___c_r_y_p_t_o___c_o_n_t_e_x_t.html">IFAPI_CRYPTO_CONTEXT_BLOB</a> **context, TPM2_ALG_ID hashAlgorithm)</td></tr>
<tr class="separator:ga1bae9ed161278e58f8e39d70f110b046"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf9c318cab007a23adef270f9c4a606b4"><td class="memItemLeft" align="right" valign="top">TSS2_RC&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fapi__crypto.html#gaf9c318cab007a23adef270f9c4a606b4">ifapi_crypto_hash_update</a> (<a class="el" href="struct___i_f_a_p_i___c_r_y_p_t_o___c_o_n_t_e_x_t.html">IFAPI_CRYPTO_CONTEXT_BLOB</a> *context, const uint8_t *buffer, size_t size)</td></tr>
<tr class="separator:gaf9c318cab007a23adef270f9c4a606b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga487ac222f6bd4074c34128627af14825"><td class="memItemLeft" align="right" valign="top">TSS2_RC&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fapi__crypto.html#ga487ac222f6bd4074c34128627af14825">ifapi_der_sig_to_tpm</a> (const TPMT_PUBLIC *tpmPublic, const unsigned char *signature, size_t signatureSize, TPMI_ALG_HASH hashAlgorithm, TPMT_SIGNATURE *tpmSignature)</td></tr>
<tr class="separator:ga487ac222f6bd4074c34128627af14825"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac56f0fce6cbb0ff4e4cba9c398f695df"><td class="memItemLeft" align="right" valign="top">TSS2_RC&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fapi__crypto.html#gac56f0fce6cbb0ff4e4cba9c398f695df">ifapi_get_hash_alg_for_size</a> (uint16_t size, TPMI_ALG_HASH *hashAlgorithm)</td></tr>
<tr class="separator:gac56f0fce6cbb0ff4e4cba9c398f695df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa97941ce97a4bc07441db3cd6b7d47f6"><td class="memItemLeft" align="right" valign="top">TPM2_RC&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fapi__crypto.html#gaa97941ce97a4bc07441db3cd6b7d47f6">ifapi_get_profile_sig_scheme</a> (const <a class="el" href="struct_i_f_a_p_i___p_r_o_f_i_l_e.html">IFAPI_PROFILE</a> *profile, const TPMT_PUBLIC *tpmPublic, TPMT_SIG_SCHEME *signatureScheme)</td></tr>
<tr class="separator:gaa97941ce97a4bc07441db3cd6b7d47f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf713079ae0eaa00544909915b126e4b7"><td class="memItemLeft" align="right" valign="top">TSS2_RC&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fapi__crypto.html#gaf713079ae0eaa00544909915b126e4b7">ifapi_get_public_from_pem_cert</a> (const char *pem_cert, TPM2B_PUBLIC *tpm_public)</td></tr>
<tr class="separator:gaf713079ae0eaa00544909915b126e4b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2749271fc949a0587ea33fd35b20c651"><td class="memItemLeft" align="right" valign="top">TPM2_ALG_ID&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fapi__crypto.html#ga2749271fc949a0587ea33fd35b20c651">ifapi_get_signature_algorithm_from_pem</a> (const char *pemKey)</td></tr>
<tr class="separator:ga2749271fc949a0587ea33fd35b20c651"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf0acb921826dd121e027f6a7ffe2e6ca"><td class="memItemLeft" align="right" valign="top">TSS2_RC&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fapi__crypto.html#gaf0acb921826dd121e027f6a7ffe2e6ca">ifapi_get_tpm2b_public_from_pem</a> (const char *pemKey, TPM2B_PUBLIC *tpmPublic)</td></tr>
<tr class="separator:gaf0acb921826dd121e027f6a7ffe2e6ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga30a2dbc9555d38d2cc07ae8039d52d42"><td class="memItemLeft" align="right" valign="top">TSS2_RC&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fapi__crypto.html#ga30a2dbc9555d38d2cc07ae8039d52d42">ifapi_get_tpm_key_fingerprint</a> (const TPM2B_PUBLIC *tpmPublicKey, TPMI_ALG_HASH hashAlg, TPM2B_DIGEST *fingerprint)</td></tr>
<tr class="separator:ga30a2dbc9555d38d2cc07ae8039d52d42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga817996f764dc590b0fcde8b2479ebd14"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fapi__crypto.html#ga817996f764dc590b0fcde8b2479ebd14">ifapi_hash_get_digest_size</a> (TPM2_ALG_ID hashAlgorithm)</td></tr>
<tr class="separator:ga817996f764dc590b0fcde8b2479ebd14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaca515b7a38f631d79c814709f8506e0e"><td class="memItemLeft" align="right" valign="top">TSS2_RC&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fapi__crypto.html#gaca515b7a38f631d79c814709f8506e0e">ifapi_initialize_sign_public</a> (TPM2_ALG_ID signatureAlgorithm, TPM2B_PUBLIC *public)</td></tr>
<tr class="separator:gaca515b7a38f631d79c814709f8506e0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga67cac597edb51e7aeab416e3b3d46194"><td class="memItemLeft" align="right" valign="top">TSS2_RC&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fapi__crypto.html#ga67cac597edb51e7aeab416e3b3d46194">ifapi_pub_pem_key_from_tpm</a> (const TPM2B_PUBLIC *tpmPublicKey, char **pemKey, int *pemKeySize)</td></tr>
<tr class="separator:ga67cac597edb51e7aeab416e3b3d46194"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga48d5eaba0929c2509a637e7e6a35990d"><td class="memItemLeft" align="right" valign="top">TSS2_RC&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fapi__crypto.html#ga48d5eaba0929c2509a637e7e6a35990d">ifapi_tpm_ecc_sig_to_der</a> (const TPMT_SIGNATURE *tpmSignature, uint8_t **signature, size_t *signatureSize)</td></tr>
<tr class="separator:ga48d5eaba0929c2509a637e7e6a35990d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3ab89d32f1c956cf65222d987dec2d2e"><td class="memItemLeft" align="right" valign="top">TSS2_RC&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fapi__crypto.html#ga3ab89d32f1c956cf65222d987dec2d2e">ifapi_curl_verify_ek_cert</a> (char *root_cert_pem, char *intermed_cert_pem, char *ek_cert_pem)</td></tr>
<tr class="separator:ga3ab89d32f1c956cf65222d987dec2d2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae1b2637abec3a461a863360c0e76cc35"><td class="memItemLeft" align="right" valign="top">TSS2_RC&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fapi__crypto.html#gae1b2637abec3a461a863360c0e76cc35">ifapi_verify_signature</a> (const <a class="el" href="struct___i_f_a_p_i___o_b_j_e_c_t.html">IFAPI_OBJECT</a> *keyObject, const uint8_t *signature, size_t signatureSize, const uint8_t *digest, size_t digestSize)</td></tr>
<tr class="separator:gae1b2637abec3a461a863360c0e76cc35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf974aab23bced5dd22e422b5ad5cbb51"><td class="memItemLeft" align="right" valign="top">TSS2_RC&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fapi__crypto.html#gaf974aab23bced5dd22e422b5ad5cbb51">ifapi_verify_signature_quote</a> (const <a class="el" href="struct___i_f_a_p_i___o_b_j_e_c_t.html">IFAPI_OBJECT</a> *keyObject, const uint8_t *signature, size_t signatureSize, const uint8_t *digest, size_t digestSize, const TPMT_SIG_SCHEME *signatureScheme)</td></tr>
<tr class="separator:gaf974aab23bced5dd22e422b5ad5cbb51"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>The types and functions used internally by FAPI for cryptographic operations. Multiple implementations of these functions for different cryptographic backends may exist. </p>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga335ce751f0d6d9288608568872cec24b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga335ce751f0d6d9288608568872cec24b">&#9670;&nbsp;</a></span>ifapi_cert_to_pem()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TSS2_RC ifapi_cert_to_pem </td>
          <td>(</td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>certBuffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>certBufferSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>pemCert</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TPM2_ALG_ID *&#160;</td>
          <td class="paramname"><em>certAlgorithmId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TPM2B_PUBLIC *&#160;</td>
          <td class="paramname"><em>tpmPublic</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Converts a TPM certificate buffer to the PEM format.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">certBuffer</td><td>A byte buffer holding the certificate </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">certBufferSize</td><td>The size of certBuffer in bytes </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pemCert</td><td>A byte buffer where the PEM-formatted certificate is stored </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">certAlgorithmId</td><td>The key type of the certified key </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tpmPublic</td><td>The public key of the certificate in TPM format.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">TSS2_RC_SUCCESS</td><td>on success </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_REFERENCE</td><td>if certBuffer or pemCert is NULL </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_MEMORY</td><td>if memory could not be allocated </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_VALUE</td><td>if the certificate is invalid </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_GENERAL_FAILURE</td><td>if an error occurs in the crypto library </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga037db3129ad84c8a032e1f3ac3233f0d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga037db3129ad84c8a032e1f3ac3233f0d">&#9670;&nbsp;</a></span>ifapi_crypto_hash_abort()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ifapi_crypto_hash_abort </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct___i_f_a_p_i___c_r_y_p_t_o___c_o_n_t_e_x_t.html">IFAPI_CRYPTO_CONTEXT_BLOB</a> **&#160;</td>
          <td class="paramname"><em>context</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Aborts a hash operation and finalizes the hash context. It will be set to NULL.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">context</td><td>The context of the digest object. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gae2feeff96f78225620819f2f6217964e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae2feeff96f78225620819f2f6217964e">&#9670;&nbsp;</a></span>ifapi_crypto_hash_finish()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TSS2_RC ifapi_crypto_hash_finish </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct___i_f_a_p_i___c_r_y_p_t_o___c_o_n_t_e_x_t.html">IFAPI_CRYPTO_CONTEXT_BLOB</a> **&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>digest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>digestSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Gets the digest value from a hash context and closes it.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">context</td><td>The hash context that is released </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">digest</td><td>The buffer for the digest value </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">digestSize</td><td>The size of digest in bytes. Can be NULL</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">TSS2_RC_SUCCESS</td><td>on success </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_REFERENCE</td><td>if context or digest is NULL </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_GENERAL_FAILURE</td><td>if an error occurs in the crypto library </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga1bae9ed161278e58f8e39d70f110b046"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1bae9ed161278e58f8e39d70f110b046">&#9670;&nbsp;</a></span>ifapi_crypto_hash_start()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TSS2_RC ifapi_crypto_hash_start </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct___i_f_a_p_i___c_r_y_p_t_o___c_o_n_t_e_x_t.html">IFAPI_CRYPTO_CONTEXT_BLOB</a> **&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TPM2_ALG_ID&#160;</td>
          <td class="paramname"><em>hashAlgorithm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Starts the computation of a hash digest.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">context</td><td>The created hash context (callee-allocated). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hashAlgorithm</td><td>The TSS hash identifier for the hash algorithm to use.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">TSS2_RC_SUCCESS</td><td>on success. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_VALUE</td><td>if hashAlgorithm is invalid </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_REFERENCE</td><td>if context is NULL </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_MEMORY</td><td>if memory cannot be allocated </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_GENERAL_FAILURE</td><td>if an error occurs in the crypto library </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gaf9c318cab007a23adef270f9c4a606b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf9c318cab007a23adef270f9c4a606b4">&#9670;&nbsp;</a></span>ifapi_crypto_hash_update()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TSS2_RC ifapi_crypto_hash_update </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct___i_f_a_p_i___c_r_y_p_t_o___c_o_n_t_e_x_t.html">IFAPI_CRYPTO_CONTEXT_BLOB</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Updates the digest value of a hash object with data from a byte buffer.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">context</td><td>The hash context that will be updated </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">buffer</td><td>The data for the update </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">size</td><td>The size of data in bytes</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">TSS2_RC_SUCCESS</td><td>on success. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_REFERENCE</td><td>for invalid parameters. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_GENERAL_FAILURE</td><td>if an error occurs in the crypto library </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga3ab89d32f1c956cf65222d987dec2d2e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3ab89d32f1c956cf65222d987dec2d2e">&#9670;&nbsp;</a></span>ifapi_curl_verify_ek_cert()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TSS2_RC ifapi_curl_verify_ek_cert </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>root_cert_pem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>intermed_cert_pem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>ek_cert_pem</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Verify EK certificate read from TPM.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">root_cert_pem</td><td>The vendor root certificate. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">intermed_cert_pem</td><td>The vendor intermediate certificate. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ek_cert_pem</td><td>The ek certificate from TPM.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">TSS2_RC_SUCCESS</td><td>on success </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_VALUE</td><td>if the verification was no successful. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_NO_CERT</td><td>if an error did occur during certificate downloading. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_GENERAL_FAILURE</td><td>if an internal error occurred. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_MEMORY</td><td>if not enough memory can be allocated. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga487ac222f6bd4074c34128627af14825"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga487ac222f6bd4074c34128627af14825">&#9670;&nbsp;</a></span>ifapi_der_sig_to_tpm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TSS2_RC ifapi_der_sig_to_tpm </td>
          <td>(</td>
          <td class="paramtype">const TPMT_PUBLIC *&#160;</td>
          <td class="paramname"><em>tpmPublic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>signature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>signatureSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TPMI_ALG_HASH&#160;</td>
          <td class="paramname"><em>hashAlgorithm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TPMT_SIGNATURE *&#160;</td>
          <td class="paramname"><em>tpmSignature</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Convert signature from DER to TPM format.</p>
<p>The signature in DER format is converted to TPM format to enable verification by the TPM.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tpmPublic</td><td>The public information of the signature key </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">signature</td><td>A byte buffer holding the DER encoded signature </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">signatureSize</td><td>The size of signature in bytes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hashAlgorithm</td><td>The TSS identifier for the hash algorithm used to compute the digest </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tpmSignature</td><td>The signature in TPM format</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">TSS2_RC_SUCCESS</td><td>on success </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_GENERAL_FAILURE</td><td>if an error occurs in the crypto library </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_REFERENCE</td><td>if tpmPublic, signature or tpmSignature is NULL </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_MEMORY</td><td>if memory could not be allocated </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_VALUE</td><td>if an invalid value was passed into the function. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gac56f0fce6cbb0ff4e4cba9c398f695df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac56f0fce6cbb0ff4e4cba9c398f695df">&#9670;&nbsp;</a></span>ifapi_get_hash_alg_for_size()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TSS2_RC ifapi_get_hash_alg_for_size </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TPMI_ALG_HASH *&#160;</td>
          <td class="paramname"><em>hashAlgorithm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Returns a suitable hash algorithm for a given digest size.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">size</td><td>The size of the digest </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">hashAlgorithm</td><td>A suitable hash algorithm for the digest size</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">TSS2_RC_SUCCESS</td><td>on success </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_REFERENCE</td><td>if hashAlgorithm is NULL </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_VALUE</td><td>if the digest size is invalid </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gaa97941ce97a4bc07441db3cd6b7d47f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa97941ce97a4bc07441db3cd6b7d47f6">&#9670;&nbsp;</a></span>ifapi_get_profile_sig_scheme()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TPM2_RC ifapi_get_profile_sig_scheme </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_i_f_a_p_i___p_r_o_f_i_l_e.html">IFAPI_PROFILE</a> *&#160;</td>
          <td class="paramname"><em>profile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TPMT_PUBLIC *&#160;</td>
          <td class="paramname"><em>tpmPublic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TPMT_SIG_SCHEME *&#160;</td>
          <td class="paramname"><em>signatureScheme</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Returns the signature scheme that is currently used in the FAPI context.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">profile</td><td>The FAPI profile from which the signing scheme is retrieved </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tpmPublic</td><td>The public key for which the signing key is fetched from the FAPI </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">signatureScheme</td><td>The currently used signature scheme</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">TSS2_RC_SUCCESS</td><td>if the signature scheme was successfully fetched </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_REFERENCE</td><td>if one of the parameters is NULL </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_VALUE</td><td>if the key type is not TPM2_ALG_RSA or TPM2_ALG_ECC </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gaf713079ae0eaa00544909915b126e4b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf713079ae0eaa00544909915b126e4b7">&#9670;&nbsp;</a></span>ifapi_get_public_from_pem_cert()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TSS2_RC ifapi_get_public_from_pem_cert </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>pem_cert</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TPM2B_PUBLIC *&#160;</td>
          <td class="paramname"><em>tpm_public</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get public information for key of a pem certificate.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pem_cert</td><td>The pem certificate. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tpm_public</td><td>The public information of the key in TPM format.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">TSS2_RC_SUCCESS</td><td>on success </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_VALUE</td><td>if the conversion fails. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_GENERAL_FAILURE</td><td>if openssl errors occur. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_REFERENCE</td><td>a invalid null pointer is passed. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_MEMORY</td><td>if not enough memory can be allocated. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga2749271fc949a0587ea33fd35b20c651"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2749271fc949a0587ea33fd35b20c651">&#9670;&nbsp;</a></span>ifapi_get_signature_algorithm_from_pem()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TPM2_ALG_ID ifapi_get_signature_algorithm_from_pem </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>pemKey</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Returns the TPM algorithm identifier that matches to the signature algorithm of a given PEM key.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pemKey</td><td>The public key from which the signature algorithm is retrieved</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">TPM2_ALG_RSA</td><td>if pemKey holds an RSA key </td></tr>
    <tr><td class="paramname">TPM2_ALG_ECC</td><td>if pemKey holds an ECC key </td></tr>
    <tr><td class="paramname">TPM2_ALG_ERROR</td><td>if the signature algorithm could not be determined </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_REFERENCE</td><td>a invalid null pointer is passed. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_MEMORY</td><td>if not enough memory can be allocated. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_VALUE</td><td>if an invalid value was passed into the function. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gaf0acb921826dd121e027f6a7ffe2e6ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf0acb921826dd121e027f6a7ffe2e6ca">&#9670;&nbsp;</a></span>ifapi_get_tpm2b_public_from_pem()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TSS2_RC ifapi_get_tpm2b_public_from_pem </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>pemKey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TPM2B_PUBLIC *&#160;</td>
          <td class="paramname"><em>tpmPublic</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Gets an object with the TPM-relevant public information of a PEM encoded public key. The information is gathered from the key itself and the currently used FAPI profile.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pemKey</td><td>A byte buffer holding the PEM encoded public key for which the public information is retrieved </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tpmPublic</td><td>The public information of pemKey</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">TSS2_RC_SUCCESS</td><td>on success </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_REFERENCE</td><td>if profile, pemKey or tpmPublic is NULL </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_MEMORY</td><td>if memory could not be allocated </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_GENERAL_FAILURE</td><td>if an error occurs in the crypto library </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_VALUE</td><td>if an invalid value was passed into the function. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga30a2dbc9555d38d2cc07ae8039d52d42"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga30a2dbc9555d38d2cc07ae8039d52d42">&#9670;&nbsp;</a></span>ifapi_get_tpm_key_fingerprint()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TSS2_RC ifapi_get_tpm_key_fingerprint </td>
          <td>(</td>
          <td class="paramtype">const TPM2B_PUBLIC *&#160;</td>
          <td class="paramname"><em>tpmPublicKey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TPMI_ALG_HASH&#160;</td>
          <td class="paramname"><em>hashAlg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TPM2B_DIGEST *&#160;</td>
          <td class="paramname"><em>fingerprint</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute the fingerprint of a TPM public key.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tpmPublicKey</td><td>The public key created by the TPM </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hashAlg</td><td>The hash algorithm used for fingerprint computation. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">fingerprint</td><td>The fingerprint digest.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">TSS2_RC_SUCCESS</td><td>on success </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_GENERAL_FAILURE</td><td>if an error occurs in the crypto library </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_MEMORY</td><td>if memory could not be allocated </td></tr>
    <tr><td class="paramname">TSS2_FAPI_BAD_REFERENCE</td><td>if tpmPublicKey or pemKeySize are NULL </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_REFERENCE</td><td>a invalid null pointer is passed. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_VALUE</td><td>if an invalid value was passed into the function. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga817996f764dc590b0fcde8b2479ebd14"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga817996f764dc590b0fcde8b2479ebd14">&#9670;&nbsp;</a></span>ifapi_hash_get_digest_size()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t ifapi_hash_get_digest_size </td>
          <td>(</td>
          <td class="paramtype">TPM2_ALG_ID&#160;</td>
          <td class="paramname"><em>hashAlgorithm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Returns the digest size of a given hash algorithm.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">hashAlgorithm</td><td>The TSS identifier of the hash algorithm</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The size of the digest produced by the hash algorithm if hashAlgorithm is valid </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>if hashAlgorithm is invalid </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gaca515b7a38f631d79c814709f8506e0e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaca515b7a38f631d79c814709f8506e0e">&#9670;&nbsp;</a></span>ifapi_initialize_sign_public()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TSS2_RC ifapi_initialize_sign_public </td>
          <td>(</td>
          <td class="paramtype">TPM2_ALG_ID&#160;</td>
          <td class="paramname"><em>signatureAlgorithm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TPM2B_PUBLIC *&#160;</td>
          <td class="paramname"><em>public</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initializes a FAPI key template for a given signature algorithm.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">signatureAlgorithm</td><td>The signature algorithm to use. Must be TPM2_ALG_RSA or TPM2_ALG_ECC </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">public</td><td>The template to initialize</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">TSS2_RC_SUCCESS</td><td>on success </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_REFERENCE</td><td>if template is NULL </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_VALUE</td><td>if signatureAlgorithm is not TPM2_ALG_RSA or TPM2_ALG_ECC </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga67cac597edb51e7aeab416e3b3d46194"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga67cac597edb51e7aeab416e3b3d46194">&#9670;&nbsp;</a></span>ifapi_pub_pem_key_from_tpm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TSS2_RC ifapi_pub_pem_key_from_tpm </td>
          <td>(</td>
          <td class="paramtype">const TPM2B_PUBLIC *&#160;</td>
          <td class="paramname"><em>tpmPublicKey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>pemKey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>pemKeySize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Convert a TPM public key into a PEM formatted byte buffer. This can be used by TLS libraries.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tpmPublicKey</td><td>The public key created by the TPM </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pemKey</td><td>A byte buffer that will hold the PEM representation of the public key (callee allocated) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pemKeySize</td><td>The size of pemKey in bytes</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">TSS2_RC_SUCCESS</td><td>on success </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_GENERAL_FAILURE</td><td>if an error occurs in the crypto library </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_MEMORY</td><td>if memory could not be allocated </td></tr>
    <tr><td class="paramname">TSS2_FAPI_BAD_REFERENCE</td><td>if tpmPublicKey or pemKeySize are NULL </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_REFERENCE</td><td>a invalid null pointer is passed. </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_VALUE</td><td>if an invalid value was passed into the function. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga48d5eaba0929c2509a637e7e6a35990d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga48d5eaba0929c2509a637e7e6a35990d">&#9670;&nbsp;</a></span>ifapi_tpm_ecc_sig_to_der()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TSS2_RC ifapi_tpm_ecc_sig_to_der </td>
          <td>(</td>
          <td class="paramtype">const TPMT_SIGNATURE *&#160;</td>
          <td class="paramname"><em>tpmSignature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t **&#160;</td>
          <td class="paramname"><em>signature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>signatureSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Convert a TPM ECDSA signature into a DER formatted byte buffer. This can be used by TLS libraries.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tpmSignature</td><td>The signature created by the TPM </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">signature</td><td>A byte buffer that will hold the DER representation of the signature (callee allocated) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">signatureSize</td><td>The size of signature in bytes. May be NULL</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">TSS2_RC_SUCCESS</td><td>on success </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_REFERENCE</td><td>if tpmSignature is NULL </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_MEMORY</td><td>if memory could not be allocated </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_GENERAL_FAILURE</td><td>if an error occurs in the crypto library </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gae1b2637abec3a461a863360c0e76cc35"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae1b2637abec3a461a863360c0e76cc35">&#9670;&nbsp;</a></span>ifapi_verify_signature()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TSS2_RC ifapi_verify_signature </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct___i_f_a_p_i___o_b_j_e_c_t.html">IFAPI_OBJECT</a> *&#160;</td>
          <td class="paramname"><em>keyObject</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>signature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>signatureSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>digest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>digestSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Verifies a signature using a given FAPI public key.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">keyObject</td><td>The FAPI public key used for verification </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">signature</td><td>The signature to verify </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">signatureSize</td><td>The size of signature in bytes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">digest</td><td>The digest of the signature </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">digestSize</td><td>The size of digest in bytes</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">TSS2_RC_SUCCESS</td><td>In case of success </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_REFERENCE</td><td>if keyObject, signature or digest is NULL </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_VALUE</td><td>if the type of the key is wrong </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_MEMORY</td><td>if memory could not be allocated </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_GENERAL_FAILURE</td><td>if an error occurs in the crypto library </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_SIGNATURE_VERIFICATION_FAILED</td><td>if the verification of the signature fails </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gaf974aab23bced5dd22e422b5ad5cbb51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf974aab23bced5dd22e422b5ad5cbb51">&#9670;&nbsp;</a></span>ifapi_verify_signature_quote()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TSS2_RC ifapi_verify_signature_quote </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct___i_f_a_p_i___o_b_j_e_c_t.html">IFAPI_OBJECT</a> *&#160;</td>
          <td class="paramname"><em>keyObject</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>signature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>signatureSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>digest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>digestSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TPMT_SIG_SCHEME *&#160;</td>
          <td class="paramname"><em>signatureScheme</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Verifies the signature created by a Quote command.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">keyObject</td><td>A FAPI key with which the signature is verified </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">signature</td><td>A byte buffer holding the signature </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">signatureSize</td><td>The size of signature in bytes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">digest</td><td>The digest of the signature </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">digestSize</td><td>The size of digest in bytes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">signatureScheme</td><td>The signature scheme</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">TSS2_RC_SUCCESS</td><td>on success </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_REFERENCE</td><td>if keyObject, signature, digest or signatureScheme is NULL </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_MEMORY</td><td>if memory could not be allocated </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_BAD_VALUE</td><td>if the PEM encoded key could not be decoded </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_GENERAL_FAILURE</td><td>if an error occurs in the crypto library </td></tr>
    <tr><td class="paramname">TSS2_FAPI_RC_SIGNATURE_VERIFICATION_FAILED</td><td>if the verification of the signature fails </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
